{% extends "base.html" %}
{% block title %}‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏ü‡∏≤‡∏£‡πå‡∏°{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏ü‡∏≤‡∏£‡πå‡∏°</h2>
    <a href="{% url 'cattle:add_calendar_event' %}" class="btn btn-success mb-3">
        ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
    </a>

    <div id="calendar"></div>

    <h3 class="mt-4">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
<table class="table table-bordered">
    <thead>
        <tr>
            <th>‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ</th>
            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</th>
            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</th>
            <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
    </thead>
    <tbody>
        {% for event in events %}
        <tr>
            <td>{{ event.cattle.name|default:event.cattle.tag_no }}</td>
            <td>{{ event.title }}</td>
            <td>{{ event.start|date:"Y-m-d" }}</td>
            <td>
                <a href="{% url 'cattle:update_calendar_event' event.id %}" class="btn btn-warning btn-sm">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</a>
                <a href="{% url 'cattle:delete_calendar_event' event.id %}" class="btn btn-danger btn-sm" onclick="return confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ô‡∏µ‡πâ?')">üóëÔ∏è ‡∏•‡∏ö</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

</div>

<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/main.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  var calendarEl = document.getElementById('calendar');
  var calendar = new FullCalendar.Calendar(calendarEl, {
    initialView: 'dayGridMonth',
    selectable: true,
    editable: true,
    eventSources: [
      {
        url: "{% url 'cattle:farm_calendar_events' %}",
        method: 'GET',
      }
    ],
    eventClick: function(info) {
      window.location.href = "/calendar/update-event/" + info.event.id + "/";
    }
  });
  calendar.render();
});
</script>
{% endblock %}
